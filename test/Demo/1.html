<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>pubuliu</title>
		<style>
			.clear{clear:both;height: 0px;zoom: 1;width: 100%;}    
			#public{width: 1022px;padding:0 10px 20px;background: blanchedalmond;}
			#public .box{width: 232px;float: left;margin-bottom: 20px;padding:0 11px}
			#public li a:hover{color:#666;}
			#public li p {line-height: 22px;}
			#public .edit-title {height: 36px;line-height: 36px;}
			#public .edit-title i {width: 34px;height: 32px;display: inline-block;float: left;background: url(http://img.res.szgla.com/yz/images/huodong/gs/tubiao.png) no-repeat -2px -191px;}
			#public .edit-title span {width: 198px;display: inline-block;float: left;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;}
			#public .edit_text {margin: 10px 0 14px;width: 100%;}
			#public .edit_bg,.public .edit_bg img {width: 232px;height: 153px;}
			#public .public1 .firstli .edit_text,.public .public3 .firstli .edit_text {height:154px;overflow: hidden;text-overflow: ellipsis;}
			#public .edit-title .hotbg{width: 32px;height: 36px;float: left;display: inline-block;background: url(http://img.res.szgla.com/yz/images/huodong/gs/tubiao.png) no-repeat -2px -230px;}
			#public .edit-title .newbg {width: 34px;height: 32px;display: inline-block;float: left;background: url(http://img.res.szgla.com/yz/images/huodong/gs/tubiao.png) no-repeat -2px -191px;}
			
			#public .moreBTn {width:130px;height:30px;cursor: pointer;font-weight:bold;font-size:20px;border-bottom: 1px solid #695636;margin: 0 auto;}
		</style>
	</head>
	
	<body>
		<div id="public">
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑一样</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑一样</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="box">
					<a href="wzym.html" target="_blank" id="public1-more">
						<h3 class="edit-title"><i class="newbg"></i><span class="edit-title-text">这是一场成功的战斗,厮杀之惨烈...</span></h3>
						<p class="edit-date">公元2016年10月26日</p>
						<p class="editer">昊天 百合花</p>
						<p class="edit_text">很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...</p>
						<div class="edit_bg"><img src="http://img.res.szgla.com/yz/images/huodong/gs/user-bg1.jpg"></div>
					</a>
			</div>
			<div class="clear"></div>
			<div class='moreBTn'>点击查看更多</div>
		</div>
	</body>

</html>
<script src="http://css.res.szgla.cn/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
<script type="text/javascript">
window.onload=function(){		
	imgLocation("public","box");
	$('.moreBTn').click( function(){
		toShow();
	})
}
var iData=[
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑","bg":"user-bg1.jpg","src":"000"},
		{"editTitleText":"1这是一场成功的战斗,厮杀之惨烈...","editDate":"公元2016年10月26日","editer":"昊天 百合花","editText":"很久以前有人问过我，在我心里，什么叫做英雄。我拟出许多的标准，或者如关羽般骁勇善战，温酒斩华雄，千里走单骑；或者如刘备般礼贤下士桃园结义，三顾茅庐；又或者像项羽一样，自刎乌江，气冲霄汉；或者似孔明般... ...","bg":"user-bg1.jpg","src":"000"}
	];
function toShow(){
	var cParent = document.getElementById("main");
	for(var i=0;i<imgData.data.length;i++){
		var ccontent = document.createElement("div");
		ccontent.className="box";
		cParent.appendChild(ccontent);
		
		var _a = document.createElement("a");
		_a.href=imgData.data[i].src;
		_a.target="_blank";
		ccontent.appendChild(_a);
		var _h3 = document.createElement("h3");
		_h3.className = "edit-title"
		var _i = document.createElement("i");
		var _span = document.createElement("span");
		_span.className="edit-title-text"
		_span.html=imgData.data[i].editTitleText;
		_h3.appendChild(_i);
		_h3.appendChild(_span);
		var boximg = document.createElement("div");
		boximg.className="bo_img";
		
		
		var img = document.createElement("img");
		img.src="./img/"+imgData.data[i].bg;
		boximg.appendChild(img);
		
		_a.appendChild(_h3);
		_a.appendChild(boximg);
	}
	imgLocation("main","box");
}


function imgLocation(parent, content){							
	//将parent下所有的content取出
	var cParent = document.getElementById(parent);
	var ccontent = getChildElement(cParent, content);
	var imgWidth = ccontent[0].offsetWidth;					//图片宽度
	//var cols = Math.floor(document.documentElement.clientWidth / imgWidth);			//获取个数
	var cols = Math.floor(cParent.offsetWidth / imgWidth);			//获取个数
	cParent.style.cssText = "width:"+imgWidth*cols+"px;margin:0 auto;";

	var boxHeightArr = [];
	for(var i=0;i<ccontent.length;i++){
		if(i<cols){
			boxHeightArr[i] = ccontent[i].offsetHeight;
			//console.log(boxHeightArr[i]);
		}else{
			var minHeight = Math.min.apply(null, boxHeightArr);
			var minIndex = getminheightLocation(boxHeightArr,minHeight);
			ccontent[i].style.position="absolute";
			ccontent[i].style.top=minHeight+"px";
			ccontent[i].style.left= ccontent[minIndex].offsetLeft+"px";
			boxHeightArr[minIndex] = boxHeightArr[minIndex]+ccontent[i].offsetHeight;

			var maxHeight = Math.max.apply(null, boxHeightArr);
			cParent.style.height=maxHeight+"px";
		}
	}
}

function getminheightLocation(boxHeightArr,minHeight){			//获取高度最小的图片
	for(var i in boxHeightArr){
		if(boxHeightArr[i]==minHeight){
			return i;
		}
	}
}

function getChildElement(parent, content){						//获取下一张图片
	var contentArr = [];
	var allcontent = parent.getElementsByTagName("*");
	for(var i=0;i<allcontent.length;i++){
		if(allcontent[i].className==content){
				contentArr.push(allcontent[i]);
		}
	}
	return contentArr;
}

//function checkFlag(){										//判断页面是否到底部
//	var scrollHeight = document.documentElement.scrollHeight||document.body.scrollHeight;	//获取文档的总高度
//	var scrollTop = document.documentElement.scrollTop||document.body.scrollTop;			//获取Y轴上滚动的距离，考虑浏览器兼容性问题; 
//	var pageHeight = document.documentElement.clientHeight||document.body.clientHeight;		//获浏览器视口高度
//	//console.log(scrollHeight+":"+scrollTop+":"+pageHeight);
//
//	if(scrollHeight<=scrollTop+pageHeight){		
//		return true;
//	}
//}



</script>