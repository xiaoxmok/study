$(function(){var t=getCookie("token"),a=GetRequest(),e=api.getGoods(a.id,i18nLanguage);$("#name").html(e.name),$("#summary").html(e.summary);var i=api.getSkuList(e.id,i18nLanguage),n=i.data,o=i.extra.param;function s(t){var a;999===t?(a=e.img_infos,t=0):0===(a=n[t].img_infos).length&&(a=e.img_infos),$(".swiper-wrapper").html(""),$(".product .small").html(""),a.forEach(function(t,a){var i='<div class="swiper-slide"><img src="'+t.url+'" alt=""></div>';$(".swiper-wrapper").append(i);var e='<a href="javascript:;" class="link"  data-name="'+a+'"><img src="'+t.url+'" alt=""></a>';$(".product .small").append(e)}),$("#price").html(toPrice(n[t].price)),login()?($("#school_price").html(toPrice(n[t].school_price)),$(".exclusive").hide()):$("#school_price").html(toPrice(n[t].education_price));var i=new Swiper(".swiper-container",{"speed":1e3,"autoplay":{"delay":3e3},"loop":!0,"pagination":{"el":".swiper-pagination"}});$(".small").on("click",".link",function(){var t=parseInt($(this).attr("data-name"))+1;i.slideTo(t,1e3,!1)})}$(".introduce").html(e.introduce),s(999);var c=n[0].id,l=[{"sku_id":c,"quantity":$("#quantity").val()}];for(var r in o)if(void 0!==o[r].value){var h;o[r].value.forEach(function(t,a){0===a?h='<a href="javascript:;" data-name="'+r+'" class="active">'+t+"</a>":h+='<a href="javascript:;" data-name="'+r+'">'+t+"</a>"});var u='<tr>\n                        <td class="td1">'+o[r].name+'：</td>\n                        <td class="td2 '+r+'">\n'+h+"                        </td>\n                    </tr>";$(".param").append(u)}function d(t){$(".zhezhao").show(),$(".tan2 .con p").html(t),$(".tan2").show(),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide()},1e3)}$(".param .td2").on("click","a",function(){$(this).parent().find("a").removeClass("active"),$(this).addClass("active");var i={},e=0;for(var e in o)void 0!==o[e].value&&(i[e]=$("."+e).find(".active").html());n.forEach(function(t,a){isEqual(t.param_value,i)&&(c=t.id,e=a)}),s(e),l=[{"sku_id":c,"quantity":$("#quantity").val()}]}),$(".add").click(function(){if(login()){a=$("#quantity").val(),i=!0;api.getCartList(getCookie("userId"),i18nLanguage,function(t){(t.forEach(function(t,a){t.sku_id===c&&(i=!1)}),i)?(console.log("quantity",a),200===api.getCartCreate(getCookie("userId"),c,a).code&&($(".zhezhao").show(),isEnglish()?$(".tan2 .con p").html("Add to Cart successful."):$(".tan2 .con p").html("加入购物车成功。"),$(".tan2").show(),api.getCartList(getCookie("userId"),i18nLanguage,function(t){$(".cart .count").html(t.length)}),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide()},1e3))):($(".zhezhao").show(),isEnglish()?$(".tan2 .con p").html("The item has been added to the shopping, please go to the shopping cart to place an order."):$(".tan2 .con p").html("该商品已经加入购物，请去购物车下单。"),$(".tan2").show(),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide()},1e3))})}else{var a=$("#quantity").val();console.log(c,a);var t=[],i=!0;if(getCookie("localCart"))(t=getCookie("localCart").split(",")).forEach(function(t,a){t.split("-")[0]==c&&(i=!1)}),i?(t.push(c+"-"+a),getCookie("localCart",t,{"expires":30,"path":"/"}),isEnglish()?d("Join the temporary shopping cart successfully!"):d("加入临时购物车成功！")):isEnglish()?d("Already in a temporary shopping cart"):d("已经在临时购物车");else t.push(c+"-"+a),getCookie("localCart",t,{"expires":30,"path":"/"}),isEnglish()?d("Join the temporary shopping cart successfully!"):d("加入临时购物车成功！");if(getCookie("localCart"))t=getCookie("localCart").split(","),$(".cart .count").html(t.length)}}),$(".buy").click(function(){if(login()){var i="";l.forEach(function(t,a){i+=0===a?"goods"+a+"="+t.sku_id+"_"+t.quantity:"&goods"+a+"="+t.sku_id+"_"+t.quantity}),location.href="submitOrder.html?"+i}else $(".zhezhao").show(),isEnglish()?$(".tan2 .con p").html("please sign in...."):$(".tan2 .con p").html("请登录。。。"),$(".tan2").show(),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide(),location.href="login.html"},1e3)}),$(".collect").click(function(){$.ajax({"type":"POST","url":url+"/api/v1/fav/create","dataType":"json","data":{"token":t,"goods_id":a.id},"success":function(t){200===t.code&&($(".zhezhao").show(),isEnglish()?$(".tan2 .con p").html("Collection success."):$(".tan2 .con p").html("收藏成功。"),$(".tan2").show(),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide()},1e3))},"error":function(){}})}),$(".contact ").click(function(){$(".zhezhao").show(),$(".tan1").show()}),$(".cls ").click(function(){$(".zhezhao").hide(),$(".tan1").hide()});var p=$(".btnNum .text").val();$(".btnNum .less").click(function(){1<p&&(p--,$(".btnNum .text").attr("value",p)),l=[{"sku_id":c,"quantity":$("#quantity").val()}]}),$(".btnNum .plus").click(function(){p++,$(".btnNum .text").attr("value",p),l=[{"sku_id":c,"quantity":$("#quantity").val()}]}),$(".productNav li").click(function(){var t=$(this).index();$(".productDetail").hide().eq(t).show(),$(".productNav li").removeClass("active"),$(this).addClass("active")})});