!function($){$.i18n={},$.i18n.map={};var debug=function(e){window.console&&console.log("i18n::"+e)};function callbackIfComplete(e){e.debug&&(debug("callbackIfComplete()"),debug("totalFiles: "+e.totalFiles),debug("filesLoaded: "+e.filesLoaded)),e.async&&e.filesLoaded===e.totalFiles&&e.callback&&e.callback()}function loadAndParseFiles(e,a){a.debug&&debug("loadAndParseFiles"),null!==e&&0<e.length?loadAndParseFile(e[0],a,function(){e.shift(),loadAndParseFiles(e,a)}):callbackIfComplete(a)}function loadAndParseFile(s,t,r){t.debug&&(debug("loadAndParseFile('"+s+"')"),debug("totalFiles: "+t.totalFiles),debug("filesLoaded: "+t.filesLoaded)),null!=s&&$.ajax({"url":"/"+s,"async":t.async,"cache":t.cache,"dataType":"text","success":function(e,a){t.debug&&(debug("Succeeded in downloading "+s+"."),debug(e)),parseData(e,t),r()},"error":function(e,a,n){t.debug&&debug("Failed to download or parse "+s+". errorThrown: "+n),404===e.status&&(t.totalFiles-=1),r()}})}function parseData(data,settings){for(var parsed="",lines=data.split(/\n/),regPlaceHolder=/(\{\d+})/g,regRepPlaceHolder=/\{(\d+)}/g,unicodeRE=/(\\u.{4})/gi,i=0,j=lines.length;i<j;i++){var line=lines[i];if(line=line.trim(),0<line.length&&"#"!=line.match("^#")){var pair=line.split("=");if(0<pair.length){for(var name=decodeURI(pair[0]).trim(),value=1==pair.length?"":pair[1];-1!=value.search(/\\$/);)value=value.substring(0,value.length-1),value+=lines[++i].trimRight();for(var s=2;s<pair.length;s++)value+="="+pair[s];if(value=value.trim(),"map"==settings.mode||"both"==settings.mode){var unicodeMatches=value.match(unicodeRE);unicodeMatches&&unicodeMatches.forEach(function(e){value=value.replace(e,unescapeUnicode(e))}),settings.namespace?$.i18n.map[settings.namespace][name]=value:$.i18n.map[name]=value}if("vars"==settings.mode||"both"==settings.mode)if(value=value.replace(/"/g,'\\"'),checkKeyNamespace(name),regPlaceHolder.test(value)){var parts=value.split(regPlaceHolder),first=!0,fnArgs="",usedArgs=[];parts.forEach(function(e){!regPlaceHolder.test(e)||0!==usedArgs.length&&-1!=usedArgs.indexOf(e)||(first||(fnArgs+=","),fnArgs+=e.replace(regRepPlaceHolder,"v$1"),usedArgs.push(e),first=!1)}),parsed+=name+"=function("+fnArgs+"){";var fnExpr='"'+value.replace(regRepPlaceHolder,'"+v$1+"')+'"';parsed+="return "+fnExpr+";};"}else parsed+=name+'="'+value+'";'}}}eval(parsed),settings.filesLoaded+=1}function checkKeyNamespace(key){var regDot=/\./;if(regDot.test(key))for(var fullname="",names=key.split(/\./),i=0,j=names.length;i<j;i++){var name=names[i];0<i&&(fullname+="."),fullname+=name,eval("typeof "+fullname+' == "undefined"')&&eval(fullname+"={};")}}function unescapeUnicode(e){var a=[],n=parseInt(e.substr(2),16);return 0<=n&&n<Math.pow(2,16)&&a.push(n),a.reduce(function(e,a){return e+String.fromCharCode(a)},"")}$.i18n.properties=function(r){(r=$.extend({"name":"Messages","language":"","path":"","namespace":null,"mode":"vars","cache":!1,"debug":!1,"encoding":"UTF-8","async":!1,"callback":null},r)).namespace&&"string"==typeof r.namespace&&(r.namespace.match(/^[a-z]*$/)?$.i18n.map[r.namespace]={}:(debug("Namespaces can only be lower case letters, a - z"),r.namespace=null)),r.path.match(/\/$/)||(r.path+="/"),r.language=this.normaliseLanguageCode(r);var e=r.name&&r.name.constructor===Array?r.name:[r.name];r.totalFiles=2*e.length+(5<=r.language.length?e.length:0),r.debug&&debug("totalFiles: "+r.totalFiles),r.filesLoaded=0,e.forEach(function(e){var a,n;a=r.path+e+".js";var s=r.language.substring(0,2);if(r.path+e+"_"+s+".js",5<=r.language.length){var t=r.language.substring(0,5);r.path+e+"_"+t+".js",n=[a]}else n=[a];loadAndParseFiles(n,r)}),r.callback&&!r.async&&r.callback()},$.i18n.prop=function(e){var a,n,s=[].slice.call(arguments);if(2==s.length)if($.isArray(s[1]))a=s[1];else if("object"==typeof s[1]){n=s[1].namespace;var t=s[1].replacements;s.splice(-1,1),t&&Array.prototype.push.apply(s,t)}var r,l=n?$.i18n.map[n][e]:$.i18n.map[e];if(null===l)return"["+(n?n+"#"+e:e)+"]";if("string"==typeof l){for(r=0;-1!=(r=l.indexOf("\\",r));)l="t"==l.charAt(r+1)?l.substring(0,r)+"\t"+l.substring(2+r++):"r"==l.charAt(r+1)?l.substring(0,r)+"\r"+l.substring(2+r++):"n"==l.charAt(r+1)?l.substring(0,r)+"\n"+l.substring(2+r++):"f"==l.charAt(r+1)?l.substring(0,r)+"\f"+l.substring(2+r++):"\\"==l.charAt(r+1)?l.substring(0,r)+"\\"+l.substring(2+r++):l.substring(0,r)+l.substring(r+1);var i,u,g=[];for(r=0;r<l.length;)if("'"==l.charAt(r))if(r==l.length-1)l=l.substring(0,r);else if("'"==l.charAt(r+1))l=l.substring(0,r)+l.substring(++r);else{for(i=r+2;-1!=(i=l.indexOf("'",i));){if(i==l.length-1||"'"!=l.charAt(i+1)){l=l.substring(0,r)+l.substring(r+1,i)+l.substring(i+1),r=i-1;break}l=l.substring(0,i)+l.substring(++i)}-1==i&&(l=l.substring(0,r)+l.substring(r+1))}else if("{"==l.charAt(r))if(-1==(i=l.indexOf("}",r+1)))r++;else if(u=parseInt(l.substring(r+1,i)),!isNaN(u)&&0<=u){var o=l.substring(0,r);""!==o&&g.push(o),g.push(u),r=0,l=l.substring(i+1)}else r=i+1;else r++;""!==l&&g.push(l),l=g,n?$.i18n.map[settings.namespace][e]=g:$.i18n.map[e]=g}if(0===l.length)return"";if(1==l.length&&"string"==typeof l[0])return l[0];var c="";for(r=0,i=l.length;r<i;r++)"string"==typeof l[r]?c+=l[r]:a&&l[r]<a.length?c+=a[l[r]]:!a&&l[r]+1<s.length?c+=s[l[r]+1]:c+="{"+l[r]+"}";return c},$.i18n.normaliseLanguageCode=function(e){var a=e.language;return(!a||a.length<2)&&(e.debug&&debug("No language supplied. Pulling it from the browser ..."),a=navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage||"en",e.debug&&debug("Language from browser: "+a)),3<(a=(a=a.toLowerCase()).replace(/-/,"_")).length&&(a=a.substring(0,3)+a.substring(3).toUpperCase()),a}}(jQuery);