$(function(){login()&&(location.href="index.html");getCookie("token"),api.getCaptcha();$("#Captcha").attr("src","http://byod.1o24.com/api/v1/system/get-captcha"),$("#Captcha").click(function(){$("#Captcha").attr("src","http://byod.1o24.com/api/v1/system/get-captcha?t="+Math.random())}),$(".code").click(function(){$(".error").html("");var e,r={},o=$("#select").children("option:selected").val();if("phone"===o){if(e=$(".account").val(),!CheckMobile(e))return void(isEnglish()?$(".error").html("Account format is incorrect."):$(".error").html("账号格式不正确."));r={"verify_type":o,"phone":e}}else if("email"===o){if(e=$(".account").val(),!CheckEmail(e))return void(isEnglish()?$(".error").html("E-mail format is incorrect."):$(".error").html("邮箱格式不正确。"));r={"verify_type":o,"email":e}}if(0!==$(".Captcha_code").val().length){r.captcha=$(".Captcha_code").val();var t,i=60;$.ajax({"type":"POST","url":url+"/api/v1/user/send-verify-code","dataType":"json","data":r,"success":function(e){200===e.code?($(".timeOut").html(i),t=setInterval(c,1e3),$(".code").hide(),$(".countDown").show()):$(".error").html(e.msg)},"error":function(e,r,o){console.log(e,r,o)}})}else isEnglish()?$(".error").html("Graphic verification code cannot be empty"):$(".error").html("图形验证码不能为空");function c(){i--,$(".timeOut").html(i),i<0&&(clearInterval(t),$(".code").show(),$(".countDown").hide(),i=10)}}),$(".submitModify").click(function(){var e,r,o,t,i;$(".error").html("");var c=$("#select").children("option:selected").val();if(o=$(".valid_code").val(),CheckCode(o))if(r=$("#password").val(),CheckPwd(r))if((i=$("#password").val())===r){if("phone"===c){if(e=$(".account").val(),!CheckMobile(e))return void(isEnglish()?$(".error").html("Account format is incorrect."):$(".error").html("账号格式不正确."));t={"verify_type":c,"phone":e,"verify_code":o,"password":r,"password_confirmation":i}}else if("email"===c){if(e=$(".account").val(),!CheckEmail(e))return void(isEnglish()?$(".error").html("E-mail format is incorrect."):$(".error").html("邮箱格式不正确。"));t={"verify_type":c,"email":e,"verify_code":o,"password":r,"password_confirmation":i}}$.ajax({"type":"POST","url":url+"/api/v1/user/reset-password","dataType":"json","data":t,"success":function(e){200===e.code?(isEnglish()?$(".error").html("Modify is successful, automatically jump to the login page."):$(".error").html("修改成功，自动跳转登录页面。"),setTimeout(function(){location.href="login.html"},2e3)):$(".error").html(e.detail)},"error":function(e,r,o){}})}else isEnglish()?$(".error").html("Confirm password is incorrect"):$(".error").html("确认密码不正确");else isEnglish()?$(".error").html("The password is illegal"):$(".error").html("密码不合法，输入5-15位数！");else isEnglish()?$(".error").html("The verification code is not in the correct format."):$(".error").html("验证码格式不正确。")})});