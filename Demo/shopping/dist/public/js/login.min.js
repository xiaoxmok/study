$(function(){login()&&(location.href="index.html"),$(".loging").click(function(){var e,o;$(".error").html("");var r=$("#select").children("option:selected").val();if("phone"===r){if(e=$(".account").val(),!CheckMobile(e))return void $(".error").html("账号格式不正确！")}else if("email"===r&&(e=$(".account").val(),!CheckEmail(e)))return void $(".error").html("邮箱格式不正确！");if(o=$(".password").val(),CheckPwd(o)){console.log(o);var i={"verify_type":r,"phone":e,"email":e,"password":o};$.ajax({"type":"POST","url":url+"/api/v1/user/login","dataType":"json","data":i,"success":function(e){console.log(e),"200"===e.success?(getCookie("token",e.token,{"expires":30,"path":"/"}),getCookie("username",e.userinfo.name,{"expires":30,"path":"/"}),getCookie("school",e.userinfo.school.name,{"expires":30,"path":"/"}),getCookie("address",e.userinfo.school.city_id,{"expires":30,"path":"/"}),getCookie("address",e.userinfo.lang,{"expires":30,"path":"/"}),$(".welcome").html("Dear "+e.userinfo.name+",欢迎访问"+e.userinfo.school.name+"专属页面。"),$(".error").html("登录成功，2秒后进入首页。"),setTimeout(function(){location.href="index.html"},2e3)):$(".error").html("登录失败")},"error":function(e,o,r){}})}else $(".error").html("密码不合法，输入5-15位数！")})});