$(function(){login()||(location.href="login.html"),$(".switch label").on("click",function(){var e=$(this).attr("class"),a=$(this).siblings("input");"switch_on"==e?(a.attr("checked",!1),a.attr("dataName","n"),$(this).attr("class","switch_off")):(a.attr("checked",!0),a.attr("dataName","y"),$(this).attr("class","switch_on"))});var a=getCookie("token");$.ajax({"type":"GET","url":url+"/api/v1/school-region/index","dataType":"json","data":{"lang":i18nLanguage},"async":!1,"success":function(e){if(200===e.code){var a=e.data;$("#schoolSearch").html(""),a.forEach(function(e,a){var t='<option value="'+e.id+'">'+e.name+"</option>";$("#schoolSearch").append(t)})}},"error":function(){}}),$(".defalutAddress span").html(void 0);var t=api.getUser(a);$('.sex[value="'+t.sex+'"]').attr("checked","true"),$('.role[value="'+t.type+'"]').attr("checked","true"),$(".name").val(t.name),$(".no").val(t.school_no),$("#schoolSearch").find('option[value="'+t.school_region_id+'"]').attr("selected",!0),"y"===t.order_email_notify?($("#check-1").attr("checked",!0),$("#check-1").attr("dataName","y"),$("#check-1").siblings("label").attr("class","switch_on")):($("#check-1").attr("checked",!1),$("#check-1").attr("dataName","n"),$("#check-1").siblings("label").attr("class","switch_off")),"y"===t.order_sms_notify?($("#check-2").attr("checked",!0),$("#check-2").attr("dataName","y"),$("#check-2").siblings("label").attr("class","switch_on")):($("#check-2").attr("checked",!1),$("#check-2").attr("dataName","n"),$("#check-2").siblings("label").attr("class","switch_off")),$(".submit").click(function(){var e={"token":a,"id":t.id,"sex":$('.sex[name="sex"]:checked').val(),"type":$('.role[name="role"]:checked').val(),"school_region_id":$("#schoolSearch").children("option:selected").val(),"order_email_notify":$("#check-1").attr("dataName"),"order_sms_notify":$("#check-2").attr("dataName"),"school_no":$(".no").val(),"default_address":$(".defalutAddress span").html()};$.ajax({"type":"POST","url":url+"/api/v1/user/update","dataType":"json","data":e,"success":function(e){200===e.code?($(".error").html("修改成功。"),setTimeout(function(){},1e3)):$(".error").html(e.msg)},"error":function(e,a,t){}})})});