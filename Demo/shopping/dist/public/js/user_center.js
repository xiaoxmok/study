$(function(){login()||(location.href="login.html");var e,a,n,t,r,i,s,d=getCookie("token"),o=api.getUser(d);"zh"===getCookie("userLanguage")?("male"===o.sex?e="男":"female"===o.sex&&(e="女"),"student"===o.type?a="学生":"teacher"===o.type?a="老师":"staff"===o.type&&(a="教职员工")):"en"===getCookie("userLanguage")&&("male"===o.sex?e="male":"female"===o.sex&&(e="female"),"student"===o.type?a="student":"teacher"===o.type?a="teacher":"staff"===o.type&&(a="staff")),$(".userName .person .name em").html(o.name),$(".userName .person .sex em").html(e),$(".userName .person .role em").html(a),t="student"===o.type?isEnglish()?"Student ID No.: ":"学号: ":isEnglish()?"Staff: ":"教职员工号: ",n=null!==o.school_no?o.school_no:isEnglish()?"unfilled":"未填写",$(".userName .person .no em").html(t+n),r=null!==o.email?o.email.split("@")[0].slice(0,-4)+"****@"+o.email.split("@")[1]:isEnglish()?"unfilled":"未填写",i=null!==o.phone?o.phone.slice(0,3)+"****"+o.phone.slice(-4):isEnglish()?"unfilled":"未填写",$(".userName .person .email em").html(r),$(".userName .person .phone em").html(i),api.getAddressList(getCookie("userId")).forEach(function(e,a){"y"===e.is_default&&(s=e.address)}),$(".userName .person .address em").html(s);var l,c,p,u=api.getSchool(o.school_info.id,i18nLanguage);function h(e){var a;if($(".pcOrder").html(""),$(".mOrder ul").html(""),a=isEnglish()?"<tr>\n                <th>Order No.</th>\n                <th>Order Status</th>\n                <th>Order Amount</th>\n                <th>Manage</th>\n            </tr>":"<tr>\n                <th>订单号</th>\n                <th>订单状态</th>\n                <th>订单金额</th>\n                <th>操作</th>\n            </tr>",$(".pcOrder").append(a),200===e.code)if(0<e.data.length){e.data.forEach(function(e,a){var n,t,r;if(n="unionpay"===e.pay_type?isEnglish()?'<a href="./payment.html?orderNo='+e.order_no+'&center=true">Go to pay</a>':'<a href="./payment.html?orderNo='+e.order_no+'&center=true">去支付</a>':isEnglish()?'<a href="javascript:;" class="toPay" data-name="'+e.order_no+'">Go to pay</a>':'<a href="javascript:;" class="toPay" data-name="'+e.order_no+'">去支付</a>',isEnglish()?"waitingForPay"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n'+n+'                    <a href="javascript:;" id="cancel" data-name="'+e.order_no+'">Cancel Order</a>\n':"paying"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n'+n+'                    <a href="javascript:;" id="cancel" data-name="'+e.order_no+'">Cancel Order</a>\n':"paid"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>':"waitingForInstall"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"installing"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"installed"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"dispatched"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"dispatching"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"waitingForSign"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.no+'">Return and Refund</a>\n':"signed"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">Request an invoice (Fapiao)</a>\n                    <a href="./returns.html?id='+e.order_no+'">Return and Refund</a>\n':"canceled"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"waitingForReturn"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"returned"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"returning"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"exchanged"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"refuseForReturn"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"waitingForExchange"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"exchanging"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n':"refuseForExchange"===e.status&&(t='              <a href="./ordersDetail.html?id='+e.order_no+'">Details</a>\n'):"waitingForPay"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n'+n+'                    <a href="javascript:;" id="cancel" data-name="'+e.order_no+'">取消订单</a>\n':"paying"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n'+n+'                    <a href="javascript:;" id="cancel" data-name="'+e.order_no+'">取消订单</a>\n':"paid"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>':"waitingForInstall"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"installing"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"installed"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"dispatching"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"dispatched"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"waitingForSign"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.no+'">退换货</a>\n':"signed"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n                    <a href="./invoice.html?order_no='+e.order_no+'">开具发票</a>\n                    <a href="./returns.html?id='+e.order_no+'">退换货</a>\n':"canceled"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"waitingForReturn"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"waitingForExchange"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"returned"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"returning"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"refuseForReturn"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"refuseForExchange"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"exchanged"===e.status?t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n':"exchanging"===e.status&&(t='              <a href="./ordersDetail.html?id='+e.order_no+'">查看详情</a>\n'),r=isEnglish()?'<tr>\n                <td>\n                    <div class="img"><img src="'+e.goods_cover_url+'" alt=""><p>'+e.goods_sum+' Pieces</p></div>\n                    <div class="con">\n                        <p>Order No.: '+e.order_no+"</p>\n                        <span>Order Created at: "+e.created_at+"</span>\n                    </div>\n                </td>\n                <td>"+l[e.status]+"</td>\n                <td>￥"+toPrice(e.price)+'</td>\n                <td class="operate">\n'+t+"                </td>\n            </tr>":'<tr>\n                <td>\n                    <div class="img"><img src="'+e.goods_cover_url+'" alt=""><p>共'+e.goods_sum+'件</p></div>\n                    <div class="con">\n                        <p>订单号：'+e.order_no+"</p>\n                        <span>下单时间："+e.created_at+"</span>\n                    </div>\n                </td>\n                <td>"+l[e.status]+"</td>\n                <td>￥"+toPrice(e.price)+'</td>\n                <td class="operate">\n'+t+"                </td>\n            </tr>",$(".pcOrder").append(r),isEnglish())var i='<li>\n                    <div class="up">\n                        <div class="img"><img src="'+e.goods_cover_url+'" alt=""><p>共'+e.goods_sum+'件</p></div>\n                        <div class="con">\n                            <p>Order No.：'+e.order_no+"</p>\n                            <span>Order Created at:"+e.created_at+'</span>\n                        </div>\n                        <div class="status">Order Status：'+l[e.status]+'</div>\n                    </div>\n                    <div class="down">\n'+t+"                    </div>\n                </li>";else i='<li>\n                    <div class="up">\n                        <div class="img"><img src="'+e.goods_cover_url+'" alt=""><p>共'+e.goods_sum+'件</p></div>\n                        <div class="con">\n                            <p>订单号：'+e.order_no+"</p>\n                            <span>下单时间："+e.created_at+'</span>\n                        </div>\n                        <div class="status">订单状态：'+l[e.status]+'</div>\n                    </div>\n                    <div class="down">\n'+t+"                    </div>\n                </li>";$(".mOrder ul").append(i)})}else{$(".pcOrder").append('<tr>\n                <td colspan="5">\n                    <p>none</p>\n                </td>\n            </tr>');var n="<li>\n                    <div>\n                        <p>none</p>\n                    </div>\n                </li>";$(".mOrder ul").append(n)}else{$(".pcOrder").append('<tr>\n                <td colspan="5">\n                    <p>error</p>\n                </td>\n            </tr>');n="<li>\n                    <div>\n                        <p>error</p>\n                    </div>\n                </li>";$(".mOrder li").append(n)}}function m(e){$(".zhezhao").show(),$(".tan2 .con p").html(e),$(".tan2").show(),setTimeout(function(){$(".zhezhao").hide(),$(".tan2").hide()},1e3)}function v(e){switch($(".list").hide().eq(e).show(),$(".orderNav li").removeClass("active"),$(".orderNav li").eq(e).addClass("active"),e){case 0:$(".pcOrder").html("Loading..."),$(".mOrder ul").html("Loading..."),api.getOrderList("",h);break;case 1:$(".collect ul").html(""),$.ajax({"type":"GET","url":url+"/api/v1/fav/index?token="+d+"&lang="+i18nLanguage,"dataType":"json","success":function(e){if(200===e.code)if(0<e.data.length)e.data.forEach(function(e,a){if(null!==e.summary?summary=e.summary:summary="Not described",isEnglish())var n='<li>\n                    <a href="./product.html?id='+e.id+'">\n                    <img src="'+e.img_infos[0].url+'" alt="">\n                    <div class="con">\n                        <p class="Title">'+e.name+'</p>\n                        <p class="description">'+summary+'</p>\n                        <p class="price"><span>MSRP：</span><del>￥'+toPrice(e.price)+'</del></p>\n                        <p class="price"><span>School Special Offer：</span><em>￥'+toPrice(e.school_price)+"</em></p>\n                    </div>\n                    </a>\n                </li>";else n='<li>\n                    <a href="./product.html?id='+e.id+'">\n                    <img src="'+e.img_infos[0].url+'" alt="">\n                    <div class="con">\n                        <p class="Title">'+e.name+'</p>\n                        <p class="description">'+summary+'</p>\n                        <p class="price"><span>常规价格：</span><del>￥'+toPrice(e.price)+'</del></p>\n                        <p class="price"><span>学校优惠价：</span><em>￥'+toPrice(e.school_price)+"</em></p>\n                    </div>\n                    </a>\n                </li>";$(".collect ul").append(n)});else{var a="<li>\n                    <p>no data</p>\n                </li>";$(".collect ul").append(a)}else a="<li>\n                    <p>no data</p>\n                </li>",$(".collect ul").append(a)},"error":function(e,a,n){}});break;case 2:$.ajax({"type":"post","url":url+"/api/v1/user/device-list","dataType":"json","data":{"token":d,"lang":i18nLanguage},"success":function(e){if(200===e.code){var a=e.data;$(".myDevice ul").html(""),a.forEach(function(e,a){var n;n=isEnglish()?'<li>\n                    <img src="'+e.img_infos[0].url+'" alt="">\n                    <div class="con">\n                        <p class="Title">'+e.goods_name+'</p>\n                        <a class="apply" href="./repairApplication.html">Request Repair</a>\n                    </div>\n                </li>':'<li>\n                    <img src="'+e.img_infos[0].url+'" alt="">\n                    <div class="con">\n                        <p class="Title">'+e.goods_name+'</p>\n                        <a class="apply" href="./repairApplication.html">申请维修</a>\n                    </div>\n                </li>',$(".myDevice ul").append(n)})}},"error":function(){}});break;case 3:$.ajax({"type":"GET","url":url+"/api/v1/coupon/index?token="+d,"dataType":"json","success":function(e){if(200===e.code){var a=e.data;$(".ticket ul").html(""),a.forEach(function(e,a){var n,t,r;t=isEnglish()?{"repair":"repair","backup":"backup","training":"training"}:{"repair":"维修券","backup":"备用机券","training":"培训券"},r="n"===e.used?isEnglish()?"Unused":"未使用":isEnglish()?"Used":"已使用",n=isEnglish()?'<li class="ticket1">\n                <div class="up">\n                    <div class="img"></div>\n                    <p>'+e.type+'</p>\n                </div>\n                <div class="down">\n                    <a href="javascript:;">'+r+"</a>\n                </div>\n            </li>":'<li class="ticket1">\n                <div class="up">\n                    <div class="img"></div>\n                    <p>'+t[e.type]+'</p>\n                </div>\n                <div class="down">\n                    <a href="javascript:;">'+r+"</a>\n                </div>\n            </li>",$(".ticket ul").append(n)})}},"error":function(e,a,n){}});break;case 4:$(".pcService").html("Loading..."),$(".mService ul").html("Loading..."),function s(){$.ajax({"type":"GET","url":url+"/api/v1/repair/index?token="+d,"dataType":"json","success":function(e){if(200===e.code){var a,n=e.data;$(".pcService").html(""),$(".mService ul").html(""),a=isEnglish()?"<tr>\n                <th>Fault description</th>\n                <th>Fault image</th>\n                <th>No.</th>\n                <th>Evaluation</th>\n                <th>Operating</th>\n                <th>Status</th>\n                <th>Backup Status</th>\n            </tr>":"<tr>\n                <th>故障描述</th>\n                <th>故障照片</th>\n                <th>设备型号</th>\n                <th>维修评估</th>\n                <th>操作</th>\n                <th>维修状态</th>\n                <th>备用状态</th>\n            </tr>",$(".pcService").append(a),n.forEach(function(e,a){var n,t,r;r=0<e.img_infos.length?e.img_infos[0].url:"";var i,s,d=!1;d="sh"!==o.school_info.city,isEnglish()?(i="uSubmited"===e.status?'<a href="javascript:;" class="cancelRepair">Cancel my request</a>':"pReceived"===e.status?'<a href="javascript:;" class="cancelRepair">Cancel my request</a>':"pEvaluated"===e.status?'<a href="javascript:;" class="confirmRepair" data-price="'+e.price+'" data-other="'+e.other_price+'">Confirm repair request</a>':"uConfirmed"===e.status&&null===e.backup_status&&d?'<a href="javascript:;" class="applyBackup">Apply Backup</a>':"pRepairing"===e.status&&null===e.backup_status&&d?'<a href="javascript:;" class="applyBackup">Apply Backup</a>':"pRepaired"===e.status?"":"uWaitingForPay"===e.status?'<a href="javascript:;" class="waitForPay" data-name="'+e.order_no+'" data-repair_no="'+e.repair_no+'" data-price="'+e.price+'" data-other="'+e.other_price+'" data-type="'+e.price_type+'">Make the payment</a>':("pReceived"===e.status||"uPaid"===e.status||e.status,""),"pNoticedUser"===e.backup_status&&(i+='<a href="javascript:;" class="receivingConfirmed">Receiving loaner confirmed</a>')):(i="uSubmited"===e.status?'<a href="javascript:;" class="cancelRepair">取消维修申请</a>':"pReceived"===e.status?'<a href="javascript:;" class="cancelRepair">取消维修申请</a>':"pEvaluated"===e.status?'<a href="javascript:;" class="confirmRepair" data-price="'+e.price+'" data-other="'+e.other_price+'">确认维修</a>':"uConfirmed"===e.status&&null===e.backup_status&&d?'<a href="javascript:;" class="applyBackup">申请备用机</a>':"pRepairing"===e.status&&null===e.backup_status&&d?'<a href="javascript:;" class="applyBackup">申请备用机</a>':"pRepaired"===e.status?"":"uWaitingForPay"===e.status?'<a href="javascript:;" class="waitForPay" data-name="'+e.order_no+'" data-repair_no="'+e.repair_no+'" data-price="'+e.price+'" data-other="'+e.other_price+'" data-type="'+e.price_type+'">支付</a>':("pReceived"===e.status||"uPaid"===e.status||e.status,""),"pNoticedUser"===e.backup_status&&(i+='<a href="javascript:;" class="receivingConfirmed">备用机确认领取</a>')),s=null!==e.backup_status?(isEnglish(),p[e.backup_status]):"",isEnglish()?(n="<tr>\n                <td><p>"+e.description+'</p></td>\n                <td><div class="img"><img src="'+r+'" alt=""></div></td>\n                <td><p>'+e.device_category_info[0]+"</p></td>\n                <td><p>"+e.evaluation+'</p></td>\n                <td class="operate" data-name="'+e.id+'">'+i+'</td>\n                <td class="status">\n                    <p>'+c[e.status]+"</p>\n                    <span>repair no："+e.repair_no+'</span>\n                </td>\n                <td class="backup_status">\n                    <p>'+s+"</p>\n                    <span>Created time："+e.created_at+"</span>\n                </td>\n            </tr>",t='<li>\n                    <div class="up">\n                        <div class="operate">\n                            <div>Status：<em>'+c[e.status]+'</em></div>\n                        </div>\n                        <div class="operate">\n                            <div>Backup Staus：<em>'+s+'</em></div>\n                        </div>\n                        <div class="operate">\n                            <div>repair no：<em>'+e.repair_no+'</em></div>\n                            <div class="status">'+c[e.status]+'</div>\n                        </div>\n                        <div class="operate">\n                            <div>order no：<em>'+e.device_category_info[0]+'</em></div>\n                            <div class="status">'+p[e.backup_status]+'</div>\n                        </div>                        <div class="text">\n                            <div class="question">\n                                <span>'+e.description+'</span>\n                            </div>\n                            <div class="assess">\n                                <span>'+e.evaluation+'</span>\n                            </div>\n                        </div>\n                        <div class="operate" data-name="'+e.id+'">\n                            <div class="time"><span>Created time：'+e.created_at+'</span></div>\n                        </div>\n                    </div>\n                    <div class="down">\n'+i+"                    </div>\n                </li>"):(n="<tr>\n                <td><p>"+e.description+'</p></td>\n                <td><div class="img"><img src="'+r+'" alt=""></div></td>\n                <td><p>'+e.device_category_info[0]+"</p></td>\n                <td><p>"+e.evaluation+'</p></td>\n                <td class="operate" data-name="'+e.id+'">'+i+'</td>\n                <td class="status">\n                    <p>'+c[e.status]+"</p>\n                    <span>单号："+e.repair_no+'</span>\n                </td>\n                <td class="backup_status">\n                    <p>'+s+"</p>\n                    <span>创建时间："+e.created_at+"</span>\n                </td>\n            </tr>",t='<li>\n                    <div class="up">\n                        <div class="operate">\n                            <div>状态：<em>'+c[e.status]+'</em></div>\n                        </div>\n                        <div class="operate">\n                            <div>备用机状态：<em>'+s+'</em></div>\n                        </div>\n                        <div class="operate">\n                            <div>单号：<em>'+e.repair_no+'</em></div>\n                        </div>\n                        <div class="operate">\n                            <div>设备型号：<em>'+e.device_category_info[0]+'</em></div>\n                        </div>                        <div class="text">\n                            <div class="question">\n                                <span>'+e.description+'</span>\n                            </div>\n                            <div class="assess">\n                                <span>'+e.evaluation+'</span>\n                            </div>\n                        </div>\n                        <div class="operate">\n                            <div class="time"><span>提交时间：'+e.created_at+'</span></div>\n                        </div>\n                    </div>\n                    <div class="down" data-name="'+e.id+'">\n'+i+"                    </div>\n                </li>"),$(".records .pcService").append(n),$(".records .mService ul").append(t)})}},"error":function(e,a,n){}}),$(".records").on("click",".cancelRepair",function(){var e=$(this);$.ajax({"type":"POST","url":url+"/api/v1/repair/update","dataType":"json","data":{"token":d,"id":e.parent().attr("data-name"),"status":"uCanceled"},"success":function(e){200===e.code?(isEnglish()?m("repair request canceled"):m("取消维修申请成功"),s()):m(e.msg)},"error":function(){}})}),$(".records").on("click",".confirmRepair",function(){var e,a=$(this);$(".tan3 .platform em").html($(this).attr("data-price")),$(".tan3 .other em").html($(this).attr("data-other")),$(".zhezhao").show(),$(".tan3").show(),$(".tan3 .typeClick div").click(function(){$(this).parent().find("div").removeClass("active"),$(this).addClass("active"),e=$(".tan3 .typeClick").find(".active").attr("data-name"),$.ajax({"type":"POST","url":url+"/api/v1/repair/confirm-price","dataType":"json","data":{"token":d,"id":a.parent().attr("data-name"),"price_type":e},"success":function(e){200===e.code?$.ajax({"type":"POST","url":url+"/api/v1/repair/update","dataType":"json","data":{"token":d,"id":a.parent().attr("data-name"),"status":"uConfirmed"},"success":function(e){200===e.code?($(".zhezhao").hide(),$(".tan3").hide(),isEnglish()?m("Confirm repair request"):m("确认维修"),location.href="./center.html?nav=4"):m(e.msg)},"error":function(){}}):m(e.msg)},"error":function(){}})})}),$(".records").on("click",".applyBackup",function(){var i=$(this);$.ajax({"type":"get","url":url+"/api/v1/coupon/index?type=backup&token="+d,"dataType":"json","success":function(e){if(200===e.code){var n,a=e.data,t=!1,r=0;a.forEach(function(e,a){"n"===e.used&&(t=!0,r+=1,n=e.id)}),t?1==(isEnglish()?confirm("You have "+r+" Loaner Coupon.One coupon will be used if you submit successfully.Confirm to submit the request?"):confirm("您当前有"+r+"张备⽤机券，提交成功后将⾃动扣除1张。是否确认提交申请？"))&&$.ajax({"type":"POST","url":url+"/api/v1/repair/update","dataType":"json","data":{"token":d,"id":i.parent().attr("data-name"),"backup_status":"uSubmited","user_backup_coupon_id":n},"success":function(e){200===e.code?(isEnglish()?m("Receiving loaner confirmed"):m("申请备用机确认领取成功"),s()):m(e.msg)},"error":function(){}}):1==(isEnglish()?confirm("Service fee might apply to loaner request. Confirm to submit the request?"):confirm("提交备⽤机申请可能产⽣服务费，是否确认提交？"))&&$.ajax({"type":"POST","url":url+"/api/v1/repair/update","dataType":"json","data":{"token":d,"id":i.parent().attr("data-name"),"backup_status":"uSubmited"},"success":function(e){200===e.code?(isEnglish()?m("Receiving loaner confirmed"):m("申请备用机确认领取成功"),s()):m(e.msg)},"error":function(){}})}},"error":function(){}})}),$(".records").on("click",".waitForPay",function(){var a,n=$(this);$(".zhezhao").show(),$(".tan4").show(),$(".typeClick div").click(function(){var e;$(this).parent().find("div").removeClass("active"),$(this).addClass("active"),a=$(this).attr("data-name"),"null"!==n.attr("data-name")?location.href="payment.html?orderNo="+n.attr("data-name")+"&pay_type="+a:("other"===n.attr("data-type")?e=n.attr("data-other"):"platform"===n.attr("data-type")&&(e=n.attr("data-other")),$.ajax({"type":"POST","url":url+"/api/v1/order/create","dataType":"json","data":{"token":d,"price":e,"order_type":"repair","pay_type":a,"repair_id":n.parent().attr("data-name")},"success":function(e){200===e.code&&(location.href="payment.html?orderNo="+e.data.orderNo)},"error":function(){}}))})}),$(".records").on("click",".receivingConfirmed",function(){var e=$(this);$.ajax({"type":"POST","url":url+"/api/v1/repair/update","dataType":"json","data":{"token":d,"id":e.parent().attr("data-name"),"backup_status":"uReceived"},"success":function(e){200===e.code?(isEnglish()?m("Loaner successfully requested"):m("备用机申请成功"),s()):m(e.msg)},"error":function(){}})})}()}}$(".school .img img").attr("src",u.logo_info.url),$(".school .con .title").html(u.name),$(".school .con span").html(u.description),l=isEnglish()?{"waitingForPay":"Waiting for payment","paying":"Waiting for payment","paid":"Paid","waitingForInstall":"Waiting for Install","installing":"Installation in Progress","installed":"Installed","dispatching":"Delivering","dispatched":"Shipped to Destination","waitingForSign":"Waiting For Sign","signed":"Delivered","canceled":"Canceled","returning":"Returning","waitingForExchange":"Waiting for Exchanging","returned":"Returned","exchanging":"Exchanging","exchanged":"Exchanged","waitingForReturn":"returnHandled"}:{"waitingForPay":"待支付","paying":"待支付","paid":"已支付","waitingForInstall":"待安装","installing":"安装中","installed":"已安装","dispatching":"配送中","dispatched":"已配送","waitingForSign":"待签收","signed":"已签收","canceled":"已取消","returning":"退货中","refuseForReturn":"退货完成","waitingForExchange":"待换货","returned":"已退货","exchanging":"换货中","exchanged":"已换货","waitingForReturn":"待退货","refuseForExchange":"拒绝换货"},$(".pcOrder").html("Loading..."),$(".mOrder ul").html("Loading..."),api.getOrderList("",h),$(".myOrder").on("click","#cancel",function(){var e=$(this).attr("data-name");api.getOrderCancel(e);api.getOrderList("",h)}),$(".myOrder").on("click",".toPay",function(){var e,a=$(this).attr("data-name");$(".zhezhao").show(),$(".tan5").show(),$(".tan5 .typeClick div").click(function(){$(".tan5 .typeClick div").removeClass("active"),$(this).addClass("active")}),$(".clear").click(function(){$(".zhezhao").hide(),$(".tan5").hide()}),$(".goPay").click(function(){e=$(this).parent().parent().find(".active").attr("data-name"),location.href="payment.html?orderNo="+a+"&center=true&pay_type="+e})}),isEnglish()?(c={"uSubmited":"Request Submitted.","pReceived":"Ruturned successfully. Waiting for assessing","pEvaluated":"Assessment accomplished. Waiting for confirmation","uConfirmed":"Repairing plan is confirmed. Repair in progress","pRepairing":"Repairing plan isconfirmed. Repair in progress","pRepaired":"Repaired successfully,to be received by user","uWaitingForPay":"Received successfully, waiting for payment","uReceived":"Receivedsuccessfully, repair accomplished","uPaid":"Paid successfully, repair accomplished","uCanceled":"repair request canceled"},p={"uSubmited":"Request submitted. Waiting for loaner","pNoticedUser":"Waiting for receiving","uReceived":"Loaner received by user.","uReturned":"Loaner delivered. To be returned.","pConfirmReturned":"Loaner returned.","none":""}):(c={"uSubmited":"提交成功待返件","pReceived":"返件成功待评估","pEvaluated":"评估完成，待用户确认维修","uConfirmed":"维修方案已确认，维修中","pRepairing":"维修方案已确认，维修中","pRepaired":"维修完成，待用户领取","uWaitingForPay":"设备已确认领取，待支付","uReceived":"设备已确认领取，维修完成","uPaid":"付款成功，维修完成","uCanceled":"已取消维修申请"},p={"uSubmited":"申请提交成功，待分配备用机","pNoticedUser":"备用机待领","uReceived":"用户已领取","uReturned":"使用中，待归还","pConfirmReturned":"确认用户归还","none":""}),$(".cls").click(function(){$(".zhezhao").hide(),$(".pop").hide()}),$(".orderNav li").click(function(){v($(this).index())});var f=GetRequest();f.nav&&v(parseInt(f.nav)),$(".forMe").click(function(){null==o.questionnaire_option_id_group?location.href="questionnaire.html":location.href="recommendForMe.html"})});